<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="제주도 대중교통 정보 - 항공편, 교통량, 버스 노선 실시간 조회">
    <meta name="keywords" content="제주도, 대중교통, 항공편, 버스, 교통량, 제주공항">
    <title>제주도 대중교통 정보 | 제주도 관광 가이드</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/transport.css">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Meta Tags -->
    <meta property="og:title" content="제주도 대중교통 정보">
    <meta property="og:description" content="제주도 항공편, 교통량, 버스 노선 실시간 정보를 한눈에 확인하세요">
    <meta property="og:image" content="../images/jeju-transport.jpg">
    <meta property="og:url" content="http://goodfaceai.dothome.co.kr/pages/transport.html">
</head>
<body class="transport-page">
    <!-- 헤더 네비게이션 -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="../index.html">
                    <i class="fas fa-mountain"></i>
                    제주도 여행
                </a>
            </div>
            
            <div class="nav-menu" id="nav-menu">
                <a href="../index.html" class="nav-link">
                    <i class="fas fa-home"></i> 홈
                </a>
                <a href="attractions.html" class="nav-link">
                    <i class="fas fa-map-marked-alt"></i> 관광명소
                </a>
                <a href="restaurants.html" class="nav-link">
                    <i class="fas fa-utensils"></i> 맛집
                </a>
                <a href="hotels.html" class="nav-link">
                    <i class="fas fa-bed"></i> 숙박
                </a>
                <a href="weather.html" class="nav-link">
                    <i class="fas fa-cloud-sun"></i> 날씨
                </a>
                <a href="maps.html" class="nav-link">
                    <i class="fas fa-map"></i> 지도
                </a>
                <a href="transport.html" class="nav-link active">
                    <i class="fas fa-bus"></i> 교통
                </a>
                <a href="info.html" class="nav-link">
                    <i class="fas fa-info-circle"></i> 여행정보
                </a>
                <a href="search.html" class="nav-link">
                    <i class="fas fa-search"></i> 검색
                </a>
            </div>
            
            <div class="nav-toggle" id="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- 메인 컨테이너 -->
    <div class="transport-container">
        <!-- 헤더 -->
        <header class="transport-header">
            <h1 class="transport-title">
                <i class="fas fa-bus"></i>
                제주도 대중교통 정보
            </h1>
            <p class="transport-subtitle">
                항공편, 교통량, 버스 노선 정보를 실시간으로 확인하세요
            </p>
            
            <!-- 컨트롤 패널 -->
            <div class="transport-controls">
                <button class="control-btn" id="refresh-btn">
                    <i class="fas fa-sync-alt"></i>
                    새로고침
                </button>
                <button class="control-btn" id="realtime-btn">
                    <i class="fas fa-broadcast-tower"></i>
                    실시간 모드
                </button>
            </div>
            
            <!-- 마지막 업데이트 -->
            <div class="last-updated" id="last-updated">
                마지막 업데이트: 로딩 중...
            </div>
        </header>

        <!-- 탭 네비게이션 -->
        <div class="transport-tabs">
            <button class="tab-btn active" data-tab="flights">
                <i class="fas fa-plane"></i>
                항공편
            </button>
            <button class="tab-btn" data-tab="traffic">
                <i class="fas fa-road"></i>
                교통량
            </button>
            <button class="tab-btn" data-tab="bus">
                <i class="fas fa-bus"></i>
                버스
            </button>
            <button class="tab-btn" data-tab="ferry">
                <i class="fas fa-ship"></i>
                여객선
            </button>
        </div>

        <!-- 콘텐츠 영역 -->
        <div class="transport-content">
            <!-- 항공편 섹션 -->
            <div class="content-section active" id="flights-section">
                <div class="flight-section">
                    <!-- 도착편 -->
                    <div class="transport-card flight-card">
                        <div class="flight-header">
                            <h2 class="flight-title">
                                <i class="fas fa-plane-arrival"></i>
                                도착편
                            </h2>
                            <span class="flight-status">운항 중</span>
                        </div>
                        <div class="flight-list" id="arrivals-list">
                            <div class="transport-loading">
                                <div class="loading-spinner"></div>
                                <span class="loading-text">도착편 정보 로딩 중...</span>
                            </div>
                        </div>
                    </div>

                    <!-- 출발편 -->
                    <div class="transport-card flight-card">
                        <div class="flight-header">
                            <h2 class="flight-title">
                                <i class="fas fa-plane-departure"></i>
                                출발편
                            </h2>
                            <span class="flight-status">운항 중</span>
                        </div>
                        <div class="flight-list" id="departures-list">
                            <div class="transport-loading">
                                <div class="loading-spinner"></div>
                                <span class="loading-text">출발편 정보 로딩 중...</span>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
            </div>

            <!-- 교통량 섹션 -->
            <div class="content-section" id="traffic-section">
                <div class="traffic-section">
                    <div class="transport-card traffic-card">
                        <h2 class="flight-title">
                            <i class="fas fa-road"></i>
                            제주도 주요 도로 교통량
                        </h2>
                        <div id="traffic-routes">
                            <div class="transport-loading">
                                <div class="loading-spinner"></div>
                                <span class="loading-text">교통량 정보 로딩 중...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 버스 섹션 -->
            <div class="content-section" id="bus-section">
                <div class="bus-section" id="bus-routes">
                    <div class="transport-loading">
                        <div class="loading-spinner"></div>
                        <span class="loading-text">버스 노선 정보 로딩 중...</span>
                    </div>
                </div>
            </div>

            <!-- 여객선 섹션 -->
            <div class="content-section" id="ferry-section">
                <div class="ferry-section" id="ferry-routes">
                    <div class="transport-loading">
                        <div class="loading-spinner"></div>
                        <span class="loading-text">여객선 운항 정보 로딩 중...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 주요 노선 안내 -->
        <div class="route-guide">
            <h2 class="guide-title">
                <i class="fas fa-route"></i>
                주요 이동 경로 안내
            </h2>
            <div class="route-items" id="major-routes">
                <div class="transport-loading">
                    <div class="loading-spinner"></div>
                    <span class="loading-text">경로 정보 로딩 중...</span>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="../js/script.js"></script>
    <script src="../js/transport.js"></script>
    <script>
        // 페이지 초기화
        document.addEventListener('DOMContentLoaded', function() {
            initTransportPage();
        });

        function initTransportPage() {
            // 탭 전환 이벤트
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    switchTab(this.dataset.tab);
                });
            });

            // 컨트롤 이벤트
            document.getElementById('refresh-btn').addEventListener('click', refreshData);
            document.getElementById('realtime-btn').addEventListener('click', toggleRealtime);

            // 데이터 로드
            setTimeout(loadAllData, 1000);
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            document.querySelectorAll('.content-section').forEach(section => section.classList.remove('active'));
            document.getElementById(`${tabName}-section`).classList.add('active');
        }

        async function loadAllData() {
            if (window.jejuTransport) {
                await Promise.all([
                    loadFlightData(),
                    loadTrafficData(), 
                    loadBusData(),
                    loadFerryData(),
                    loadMajorRoutes()
                ]);
                updateLastUpdated();
            }
        }

        async function loadFlightData() {
            try {
                const data = await window.jejuTransport.getFlightInfo();
                
                document.getElementById('arrivals-list').innerHTML = data.arrivals.map(flight => `
                    <div class="flight-item">
                        <div class="flight-info">
                            <div class="flight-detail">
                                <div class="flight-label">편명</div>
                                <div class="flight-value">${flight.flightNumber}</div>
                            </div>
                            <div class="flight-detail">
                                <div class="flight-label">항공사</div>
                                <div class="flight-value">${flight.airline}</div>
                            </div>
                            <div class="flight-detail">
                                <div class="flight-label">출발지</div>
                                <div class="flight-value">${flight.origin}</div>
                            </div>
                            <div class="flight-detail">
                                <div class="flight-label">시간</div>
                                <div class="flight-value">${flight.scheduledTime}</div>
                            </div>
                            <div class="flight-detail">
                                <div class="flight-label">상태</div>
                                <div class="flight-value">${flight.status}</div>
                            </div>
                        </div>
                    </div>
                `).join('');

                document.getElementById('departures-list').innerHTML = data.departures.map(flight => `
                    <div class="flight-item">
                        <div class="flight-info">
                            <div class="flight-detail">
                                <div class="flight-label">편명</div>
                                <div class="flight-value">${flight.flightNumber}</div>
                            </div>
                            <div class="flight-detail">
                                <div class="flight-label">항공사</div>
                                <div class="flight-value">${flight.airline}</div>
                            </div>
                            <div class="flight-detail">
                                <div class="flight-label">목적지</div>
                                <div class="flight-value">${flight.destination}</div>
                            </div>
                            <div class="flight-detail">
                                <div class="flight-label">시간</div>
                                <div class="flight-value">${flight.scheduledTime}</div>
                            </div>
                            <div class="flight-detail">
                                <div class="flight-label">상태</div>
                                <div class="flight-value">${flight.status}</div>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                showError('arrivals-list', '항공편 정보 로드 실패');
                showError('departures-list', '항공편 정보 로드 실패');
            }
        }

        async function loadTrafficData() {
            try {
                const data = await window.jejuTransport.getTrafficInfo();
                
                document.getElementById('traffic-routes').innerHTML = data.routes.map(route => `
                    <div class="traffic-route">
                        <div class="route-name">${route.name}</div>
                        <div class="traffic-metrics">
                            <div class="traffic-metric">
                                <div class="metric-label">교통량</div>
                                <div class="metric-value">${route.traffic.volume}</div>
                            </div>
                            <div class="traffic-metric">
                                <div class="metric-label">속도</div>
                                <div class="metric-value">${route.traffic.speed}</div>
                            </div>
                            <div class="traffic-status status-${route.traffic.status === '원활' ? 'smooth' : route.traffic.status === '보통' ? 'normal' : 'heavy'}">
                                ${route.traffic.status}
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                showError('traffic-routes', '교통량 정보 로드 실패');
            }
        }

        async function loadBusData() {
            try {
                const data = await window.jejuTransport.getBusRoutes();
                
                document.getElementById('bus-routes').innerHTML = data.routes.map(bus => `
                    <div class="transport-card bus-card">
                        <div class="bus-header">
                            <div class="bus-number">${bus.routeNumber}</div>
                            <div class="bus-name">${bus.routeName}</div>
                            <div class="bus-type">${bus.type}</div>
                        </div>
                        <div class="bus-info">
                            <div class="bus-detail">
                                <i class="fas fa-clock"></i> 배차: ${bus.interval}
                            </div>
                            <div class="bus-detail">
                                <i class="fas fa-sun"></i> 첫차: ${bus.firstBus}
                            </div>
                            <div class="bus-detail">
                                <i class="fas fa-moon"></i> 막차: ${bus.lastBus}
                            </div>
                            <div class="bus-detail">
                                <i class="fas fa-won-sign"></i> 요금: ${bus.fare.adult}원
                            </div>
                        </div>
                        <div class="bus-stops">
                            <div class="stops-title">주요 정류장</div>
                            <div class="stops-list">
                                ${bus.mainStops.map(stop => `<span class="stop-item">${stop}</span>`).join('')}
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                showError('bus-routes', '버스 정보 로드 실패');
            }
        }

        async function loadFerryData() {
            try {
                // ferry-routes 요소를 ferry-content로 대체
                const ferrySection = document.getElementById('ferry-routes');
                ferrySection.innerHTML = '<div id="ferry-content"></div>';
                
                // getFerryInfo 함수 호출 (displayFerryInfo는 자동 호출됨)
                await window.jejuTransport.getFerryInfo();
                    <div class="transport-card ferry-card">
                        <div class="ferry-header">
                            <div class="ferry-route">${ferry.routeName}</div>
                            <div class="ferry-status ${ferry.status === '정상운항' ? 'normal' : ferry.status === '지연' ? 'delayed' : 'cancelled'}">
                                ${ferry.status}
                            </div>
                        </div>
                        <div class="ferry-info">
                            <div class="ferry-detail">
                                <i class="fas fa-ship"></i> 선박: ${ferry.shipName}
                            </div>
                            <div class="ferry-detail">
                                <i class="fas fa-building"></i> 운항사: ${ferry.company}
                            </div>
                            <div class="ferry-detail">
                                <i class="fas fa-clock"></i> 소요시간: ${ferry.duration}
                            </div>
                            <div class="ferry-detail">
                                <i class="fas fa-won-sign"></i> 요금: ${ferry.fare.adult.toLocaleString()}원
                            </div>
                        </div>
                        <div class="ferry-schedule">
                            <div class="schedule-title">
                                <i class="fas fa-calendar-alt"></i> 운항 시간표
                            </div>
                            <div class="time-info">
                                <div class="time-item">
                                    <div class="time-label">출발</div>
                                    <div class="time-value">${ferry.departureTime}</div>
                                </div>
                                <div class="time-item">
                                    <i class="fas fa-arrow-right" style="color: var(--transport-accent);"></i>
                                </div>
                                <div class="time-item">
                                    <div class="time-label">도착</div>
                                    <div class="time-value">${ferry.arrivalTime}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                showError('ferry-routes', '여객선 정보 로드 실패');
            }
        }

        async function loadMajorRoutes() {
            try {
                const routes = window.jejuTransport.majorRoutes;
                
                document.getElementById('major-routes').innerHTML = routes.map(route => `
                    <div class="route-item">
                        <div class="route-header">
                            <div class="route-title">${route.name}</div>
                            <div class="route-distance">${route.distance}</div>
                        </div>
                        <div class="route-options">
                            <div class="route-option">
                                <div class="option-type">버스</div>
                                <div class="option-time">${route.time.bus}</div>
                                <div class="option-cost">${route.cost.bus.toLocaleString()}원</div>
                            </div>
                            <div class="route-option">
                                <div class="option-type">택시</div>
                                <div class="option-time">${route.time.taxi}</div>
                                <div class="option-cost">${route.cost.taxi.toLocaleString()}원</div>
                            </div>
                            <div class="route-option">
                                <div class="option-type">렌터카</div>
                                <div class="option-time">${route.time.car}</div>
                                <div class="option-cost">${route.cost.car.toLocaleString()}원</div>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                showError('major-routes', '경로 정보 로드 실패');
            }
        }

        function showError(elementId, message) {
            document.getElementById(elementId).innerHTML = `
                <div class="transport-error">
                    <i class="fas fa-exclamation-triangle"></i>
                    <p>${message}</p>
                    <button onclick="loadAllData()">다시 시도</button>
                </div>
            `;
        }

        function updateLastUpdated() {
            const time = new Date().toLocaleTimeString('ko-KR');
            document.getElementById('last-updated').textContent = `마지막 업데이트: ${time}`;
        }

        function refreshData() {
            const btn = document.getElementById('refresh-btn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 새로고침';
            loadAllData().finally(() => {
                btn.innerHTML = '<i class="fas fa-sync-alt"></i> 새로고침';
            });
        }

        let realtimeInterval = null;
        function toggleRealtime() {
            const btn = document.getElementById('realtime-btn');
            
            if (realtimeInterval) {
                clearInterval(realtimeInterval);
                realtimeInterval = null;
                btn.innerHTML = '<i class="fas fa-broadcast-tower"></i> 실시간 모드';
                btn.classList.remove('active');
            } else {
                realtimeInterval = setInterval(loadAllData, 300000);
                btn.innerHTML = '<i class="fas fa-stop"></i> 실시간 중지';
                btn.classList.add('active');
            }
        }
    </script>
</body>
</html>